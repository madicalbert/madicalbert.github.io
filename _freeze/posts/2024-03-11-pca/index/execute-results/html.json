{
  "hash": "d7e73671efb98bd2aecb096edf477f6f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Principal Components Analysis\"\ndescription: \"Using PCA to explore the relationship between historical redlining practices and current health outcomes in the United States.\"\nauthor:\n  - name: Madison Calbert\n    url: https://madicalbert.github.io/\n    affiliation: ESM 244 Advanced Data Analysis - Master of Environmental Science & Management Program @ The Bren School (UCSB)\n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-science-and-management \ndate: 03-11-2024\ncategories: [R, Modeling, Data Visualization] # self-defined categories\ncitation: \n  url: https://madicalbert.github.io/posts/2024-03-10-pca/ \nimage: preview-image.png\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\nformat: \n  html: \n    code-fold: true\n    toc: true \n    embed-resources: true\neditor: visual\nexecute: \n  echo: true\n  message: false\n  warning: false\n---\n\n\n\n![The United States Department of Agriculture (USDA).](usda-produce.jpg)\n\n## Overview\n\nIn this report, I conduct a principal component analysis (PCA) on a data set of food nutrient information from the USDA National Nutrient Database. The dataset includes a variety of information, but I choose to focus on energy (kcal), protein (grams), fat (grams), sugar (grams), fiber (grams), and vitamin B12 (micrograms) for five different food groups: Beef Products, Fast Foods, Fruits and Fruit Juices, Nut and Seed Products, Poultry Product, and Vegetables and Vegetable Products. I use PCA to explore the relationships between these nutrients and food groups.\n\n## Pseudocode\n\n-   Load necessary packages\n-   Load data\n-   Clean data: filter for specific food groups, clean column names, drop NAs\n-   Visualize data: histograms\n-   Conduct PCA\n-   Visualize PCA results\n\n## Load packages and data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(ggfortify)\nlibrary(janitor)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nusda_raw <- read.csv(here(\"posts/2024-03-11-pca/data/usda_nutrients.csv\"))\n\nusda_df <- usda_raw %>% \n  select(FoodGroup, Energy_kcal, Protein_g, Fat_g, Sugar_g, Fiber_g, VitB12_mcg) %>% \n  filter() %>% \n  clean_names()\n```\n:::\n\n\n\nIn this report I use [data from USDA National Nurtient Database (Food Data Central)](https://fdc.nal.usda.gov/index.html). Food Data Central (FDC) serves as a comprehensive resource for food composition data compiled by the United States Department of Agriculture (USDA). FDC provides data to a vast array of food information, including nutrient profiles, serving sizes, and ingredient lists for thousands of food items.\n\nI examine the following selected variables:\n\n* energy (kcal)\n* protein (grams)\n* fat (grams)\n* sugar (grams)\n* fiber (grams)\n* vitamin B12 (micrograms)\n\nfor the following food groups:\n\n* Beef Products\n* Fast Foods\n* Fruits and Fruit Juices\n* Nut and Seed Products\n* Poultry Products\n* Vegetables and Vegetable Products\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# usda_long <- usda_df %>%\n#   pivot_longer(names_to = 'name', values_to = 'value', where(is.numeric)) \n# \n# ggplot(usda_long, aes(x = value)) +\n#   geom_histogram() +\n#   facet_wrap(~ name, scales = 'free_x')\n```\n:::\n\n\n\n## Principal component analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusda_data <- usda_df %>% \n  drop_na() %>% \n  filter(food_group %in% c(\"Beef Products\",\"Fast Foods\",\"Fruits and Fruit Juices\",\"Nut and Seed Products\",\"Poultry Products\",\"Vegetables and Vegetable Products\")) %>% \n  mutate(food = factor(food_group)) \n\nusda_pca <- usda_data %>% \n  select(where(is.numeric)) %>%\n  prcomp(scale = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# usda_pca$rotation\n\n# The first principal component (PC1) is strongly positively correlated with energy, protein, fat, and vitamin B12, and negatively correlated with sugar and fiber.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(usda_pca,\n     \tdata = usda_data, ### can grab the other data like names from this df\n     \tloadings = TRUE, \n     \tcolour = 'food', ### point color based on this variable \n     \tloadings.label = TRUE, ### label loadings with axis names \n     \tloadings.colour = \"black\", \n     \tloadings.label.colour = \"black\",\n     \tloadings.label.vjust = -0.5\n     \t) +\n  # scale_color_manual(values = c('red', 'orange', 'yellowgreen', 'darkgreen')) +\n  theme_minimal() \n```\n\n::: {.cell-output-display}\n![PCA results for USDA nutrient data. Points are colored by food group.](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nA brief summary:\n\n-   Based on the biplot, we can see that sugar and vitamin B12 are negatively correlated, while energy and fat are positively correlated.\n-   Based on the biplot, fiber and sugar are somewhat positively correlated, while protein and vitamin B12 are somewhat positively correlated.\n-   Fiber and fat as well as fiber and energy have no correlation.\n-   Nut and Seed products are the most distinct food group.\n-   Beef Products, Fast Foods, and Poultry Products are similar food groups and clustered together.\n-   Fruits and Fruit Juices and Vegetables and Vegetable Products are similar food groups and clustered together.\n\n## Variance explained\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd_vec <- usda_pca$sdev\nvar_vec <- sd_vec^2 ### standard deviation is sqrt of variance!\npc_names <- colnames(usda_pca$rotation)\n\npct_expl_df <- data.frame(v = var_vec, ### all the variance explained by the PCs\n                          pct_v = var_vec / sum(var_vec),\n                          pc = pc_names) %>% \n  mutate(pct_lbl = paste0(round(pct_v*100, 1), '%')) ### create a text label \n\nggplot(pct_expl_df, aes(x = pc, y = v)) +\n  geom_col() +\n  geom_text(aes(label = pct_lbl), vjust = 0, nudge_y = .002) +\n  labs(x = 'Principal component', y = 'Variance explained') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Variance explained by each principal component.](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nThe first principal component (PC1) explains 37.5% of the variance, while the second principal component (PC2) explains 26.4% of the variance. The third principal component (PC3) explains 15.3% of the variance, and the fourth principal component (PC4) explains 11.6% of the variance. The fifth principal component (PC5) explains 8.3% of the variance, and the sixth principal component (PC6) explains 0.9% of the variance.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}